<!DOCTYPE html>
<html lang="zh_cn">
<head>
        <meta charset="utf-8" />
        <title>Hsu's Home - interval]</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Hsu's Home </a></h1>
                <nav><ul>
                    <li><a href="/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/2017-8-28-python-interval-qu-jian-chu-li.html">2017-8-28 python interval  区间处理</a></h1>
<footer class="post-info">
        <abbr class="published" title="2017-08-28T18:25:08+08:00">
                Published: Mon 28 August 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/chihwei-hsu.html">Chihwei-Hsu</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>
<p>tags: <a href="/tag/python.html">[Python</a> <a href="/tag/qu-jian.html">区间</a> <a href="/tag/interval.html">interval]</a> </p>
</footer><!-- /.post-info --><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">volume1</span> <span class="o">=</span> <span class="n">Interval</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;Foe&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">volume2</span> <span class="o">=</span> <span class="n">Interval</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s2">&quot;Fog&quot;</span><span class="p">,</span> <span class="s2">&quot;McAfee&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">volume3</span> <span class="o">=</span> <span class="n">Interval</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s2">&quot;McDonalds&quot;</span><span class="p">,</span> <span class="s2">&quot;Space&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">volume4</span> <span class="o">=</span> <span class="n">Interval</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s2">&quot;Spade&quot;</span><span class="p">,</span> <span class="s2">&quot;Zygote&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">encyclopedia</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="p">([</span><span class="n">volume1</span><span class="p">,</span> <span class="n">volume2</span><span class="p">,</span> <span class="n">volume3</span><span class="p">,</span> <span class="n">volume4</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mySet</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="p">([</span><span class="n">volume1</span><span class="p">,</span> <span class="n">volume3</span><span class="p">,</span> <span class="n">volume4</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;Meteor&quot;</span> <span class="ow">in</span> <span class="n">encyclopedia</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;Goose&quot;</span> <span class="ow">in</span> <span class="n">encyclopedia</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;Goose&quot;</span> <span class="ow">in</span> <span class="n">mySet</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">volume2</span> <span class="ow">in</span> <span class="p">(</span><span class="n">encyclopedia</span> <span class="o">^</span> <span class="n">mySet</span><span class="p">)</span>
<span class="bp">True</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span> <span class="mi">112</span> 
<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span>  <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span> 
   <span class="o">...</span><span class="p">:</span> 
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="bp">False</span> 
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span>  <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span> 
   <span class="o">...</span><span class="p">:</span> 
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="bp">True</span> 
</pre></div>


<div class="highlight"><pre><span></span><span class="n">python强大的区间处理库interval用法介绍</span>
<span class="err">原文发表在我的博客主页，转载请注明出处</span>

<span class="err">前言</span>

<span class="err">这个库是在阅读别人的源码的时候看到的，觉得十分好用，然而在网上找到的相关资料甚少，所以阅读了源码来做一个简单的用法总结。在网络的路由表中，经常会通过掩码来表示流表的匹配域，在</span><span class="n">python中有的时候为了方便的模拟流表的匹配过程</span><span class="err">，可以通过一个整数区间来表示诸如</span><span class="n">IP等的匹配范围</span><span class="err">，而本文介绍的库在区间处理上是十分的强大与方便。</span>

<span class="err">用法举例</span>

<span class="err">不论是在</span><span class="n">Linux系统还是Windows系统上</span><span class="err">，我们都可以方便的安装</span><span class="n">pip或者easy_install库来方便的安装大多数python库</span><span class="err">，</span><span class="n">interval也不例外</span><span class="err">。</span>
<span class="err">在这个库中提供了两个主要的类，分别是</span><span class="n">Interval和IntervalSet两个类</span><span class="err">。</span>
<span class="n">Interval类描述了一个连续的范围区间</span><span class="err">，这个区间可以是闭、开、半闭半开、无穷的，他的区间值不一定是数字，可以包含任何的数据类型，比如字符串，时间等等，同时他和</span><span class="n">python的各种操作</span><span class="err">（</span><span class="o">&lt;</span><span class="p">,</span> <span class="o">&lt;=</span><span class="p">,</span> <span class="o">==</span><span class="p">,</span> <span class="o">&gt;=</span><span class="p">,</span> <span class="o">&gt;</span><span class="err">等）也是兼容的。</span><span class="n">IntervalSet包含了一个或多个互不相交的Interval集合</span><span class="err">。下面的这几个例子是源码中的。</span>

 <span class="o">&gt;&gt;&gt;</span><span class="n">volume1</span> <span class="o">=</span> <span class="n">Interval</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;Foe&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">volume2</span> <span class="o">=</span> <span class="n">Interval</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s2">&quot;Fog&quot;</span><span class="p">,</span> <span class="s2">&quot;McAfee&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">volume3</span> <span class="o">=</span> <span class="n">Interval</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s2">&quot;McDonalds&quot;</span><span class="p">,</span> <span class="s2">&quot;Space&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">volume4</span> <span class="o">=</span> <span class="n">Interval</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s2">&quot;Spade&quot;</span><span class="p">,</span> <span class="s2">&quot;Zygote&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">encyclopedia</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="p">([</span><span class="n">volume1</span><span class="p">,</span> <span class="n">volume2</span><span class="p">,</span> <span class="n">volume3</span><span class="p">,</span> <span class="n">volume4</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">mySet</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="p">([</span><span class="n">volume1</span><span class="p">,</span> <span class="n">volume3</span><span class="p">,</span> <span class="n">volume4</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span><span class="s2">&quot;Meteor&quot;</span> <span class="ow">in</span> <span class="n">encyclopedia</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span><span class="s2">&quot;Goose&quot;</span> <span class="ow">in</span> <span class="n">encyclopedia</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span><span class="s2">&quot;Goose&quot;</span> <span class="ow">in</span> <span class="n">mySet</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">volume2</span> <span class="ow">in</span> <span class="p">(</span><span class="n">encyclopedia</span> <span class="o">^</span> <span class="n">mySet</span><span class="p">)</span>
<span class="bp">True</span>
<span class="err">前面的三个例子比较容易理解，最后一个例子中，</span><span class="n">encyclopedia的区别就是mySet多了一个volume2</span><span class="err">，而异或就是将两个集合中相同的元素去掉，不同的元素保留，所以最后只剩下了</span><span class="n">volume2</span><span class="err">。</span>
<span class="err">除了字符串，利用</span><span class="n">interval还可以很方便的处理时间</span><span class="err">，下面的例子同样来自于源码。</span>

 <span class="o">&gt;&gt;&gt;</span><span class="n">officeHours</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s2">&quot;08:00&quot;</span><span class="p">,</span> <span class="s2">&quot;17:00&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">myLunch</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s2">&quot;11:30&quot;</span><span class="p">,</span> <span class="s2">&quot;12:30&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">myHours</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s2">&quot;08:30&quot;</span><span class="p">,</span> <span class="s2">&quot;19:30&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">myLunch</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">myHours</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">officeHours</span><span class="p">)</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span><span class="s2">&quot;12:00&quot;</span> <span class="ow">in</span> <span class="n">myHours</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span><span class="s2">&quot;15:30&quot;</span> <span class="ow">in</span> <span class="n">myHours</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">inOffice</span> <span class="o">=</span> <span class="n">officeHours</span> <span class="o">&amp;</span> <span class="n">myHours</span>
<span class="o">&gt;&gt;&gt;</span><span class="k">print</span> <span class="n">inOffice</span>
<span class="p">[</span><span class="s1">&#39;08:30&#39;</span><span class="o">..</span><span class="s1">&#39;11:30&#39;</span><span class="p">),(</span><span class="s1">&#39;12:30&#39;</span><span class="o">..</span><span class="s1">&#39;17:00&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">overtime</span> <span class="o">=</span> <span class="n">myHours</span> <span class="o">-</span> <span class="n">officeHours</span>
<span class="o">&gt;&gt;&gt;</span><span class="k">print</span> <span class="n">overtime</span>
<span class="p">(</span><span class="s1">&#39;17:00&#39;</span><span class="o">..</span><span class="s1">&#39;19:30&#39;</span><span class="p">]</span>
<span class="err">在前言中说道</span><span class="n">interval库可以处理IP地址</span><span class="err">，简单的列举应用如下：</span>

 <span class="c1"># coding</span>
<span class="n">r1</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="p">([</span><span class="n">Interval</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">1100</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)])</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="p">([</span><span class="n">Interval</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">1150</span><span class="p">,</span> <span class="mi">1300</span><span class="p">)])</span>

<span class="n">r3</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="p">([</span><span class="n">Interval</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)])</span>
<span class="n">r4</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="p">([</span><span class="n">Interval</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)])</span>
<span class="n">r5</span> <span class="o">=</span> <span class="n">IntervalSet</span><span class="p">([</span><span class="n">Interval</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">12000</span><span class="p">)])</span>

<span class="k">print</span> <span class="p">(</span><span class="n">r3</span> <span class="o">-</span> <span class="n">r4</span><span class="p">),</span> <span class="p">(</span><span class="n">r4</span> <span class="o">-</span> <span class="n">r3</span><span class="p">),</span> <span class="n">r3</span> <span class="o">&amp;</span> <span class="n">r4</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">IntervalSet</span><span class="o">.</span><span class="n">empty</span><span class="p">())</span>

<span class="k">if</span> <span class="n">r3</span> <span class="o">&amp;</span> <span class="n">r4</span> <span class="o">==</span> <span class="n">r4</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;yes&#39;</span>

<span class="k">print</span> <span class="n">r3</span> <span class="o">&amp;</span> <span class="n">r4</span>
<span class="k">if</span> <span class="p">(</span><span class="n">r3</span> <span class="o">-</span> <span class="n">r4</span><span class="p">)</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
   <span class="k">print</span> <span class="s2">&quot;true&quot;</span>
<span class="k">print</span> <span class="p">(</span><span class="n">r3</span> <span class="o">-</span> <span class="n">r4</span><span class="p">)</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>

<span class="c1"># output</span>
<span class="o">&lt;</span><span class="n">Empty</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">Empty</span><span class="o">&gt;</span> <span class="p">[</span><span class="mf">1000.</span><span class="o">.</span><span class="mi">3000</span><span class="p">]</span>
<span class="mi">0</span>
<span class="n">yes</span>
<span class="p">[</span><span class="mf">1000.</span><span class="o">.</span><span class="mi">3000</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">Empty</span><span class="o">&gt;</span>
<span class="err">常用方法</span>

<span class="n">interval对象初始化参数</span><span class="err">（</span><span class="n">lower_bound</span><span class="o">=-</span><span class="n">Inf</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="n">Inf</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="err">）三个</span><span class="n">boolean参数closed</span><span class="p">,</span><span class="n">lower_closed</span><span class="p">,</span><span class="n">upper_closed分表表示全闭</span><span class="err">，左闭右开，左开右闭。比如：</span><span class="n">r</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="n">upper_bound</span><span class="o">=</span><span class="mi">62</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">between</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="err">：返回以</span><span class="n">a和b为界的区间</span>
<span class="n">less_than</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="err">：小于</span><span class="n">a的所有值构成interval</span><span class="err">，类似的还有</span><span class="n">less_than_or_equal_to</span><span class="err">，</span><span class="n">greater_than</span><span class="err">，</span><span class="n">greater_than_or_equal_to函数</span>
<span class="n">join</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="err">：将两个连续的</span><span class="n">intervals组合起来</span>
<span class="n">overlaps</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="err">：两个区间是否有重叠</span>
<span class="n">adjacent_to</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="err">：两个区间是否不重叠的毗邻</span>
<span class="err">总结</span>

<span class="err">是一篇总结文章，并没有什么深度，只是为了不再重复造轮子，在必要的时候一个库可以极大的提高效率。</span>
<span class="n">MeasureMeasure</span>
</pre></div>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>